{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst API_KEY = '42494540-1ca0643de0a334de28e64a581';\n\nexport class PixabayAPI {\n  constructor(perPage) {\n    this.page = 1;\n    this.query = null;\n    this.perPage = perPage || 15;\n    this.lastPage = null;\n  }\n\n  async fetchPhotosByQuery() {\n    const response = await axios.get('', {\n      params: {\n        image_type: 'photo',\n        orientation: 'horizontal',\n        q: this.query,\n        page: this.page,\n        per_page: this.perPage,\n        key: API_KEY,\n        safesearch: true,\n      },\n    });\n\n    if (response.status === 200) {\n        \n      return response.data;\n    } else {\n      console.error('Error fetching photos:', response.statusText);\n      return null;\n    }\n  }\n  \n  resetPage() {\n    this.page = 1;\n  }\n}\n","export function createMarkup(data) {\n  return data.hits\n    .map(\n      data =>\n        `<li class=\"image-search\">\n        <a class=\"gallery-link\" href=\"${data.largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${data.webformatURL}\" alt=\"${data.tags}\"/>\n        </a>\n        <ul class=\"gallery-image-info\">\n          <li class=\"image-items\">\n            <p class=\"image-info\"><span class=\"text\">Likes</span>${data.likes}</p>\n            <p class=\"image-info\"><span class=\"text\">Views</span>${data.views}</p>\n            <p class=\"image-info\"><span class=\"text\">Comments</span>${data.comments}</p>\n            <p class=\"image-info\"><span class=\"text\">Downloads</span>${data.downloads}</p>\n          </li>\n        </ul>\n      </li>`\n    )\n    .join('');\n}\n","// Описаний у документації\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n// Описаний у документації\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { PixabayAPI } from './js/pixabay-api.js';\nimport { createMarkup } from './js/render-functions.js';\nconst pixabayAPI = new PixabayAPI();\nconst gallery = document.getElementById('gallery-container');\nconst loadMoreBtn = document.getElementById('load-more-btn');\nconst loader = document.getElementById('loading-indicator');\nconst searchForm = document.getElementById('search-form');\nconst searchInput = document.getElementById('search-input');\nconst endMessage = document.getElementById('end-of-results-message');\nconst lightbox = new SimpleLightbox('.gallery a', {\n  nav: true,\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 150,\n});\nendMessage.style.display = 'none';\nloadMoreBtn.style.display = 'none';\nlet card = 0;\nlet currentPage = pixabayAPI.page;\n\nfunction smoothScrollByCard() {\n  const scrollAmount = card * 2;\n  window.scrollBy({ top: scrollAmount, behavior: 'smooth' });\n  console.log(smoothScrollByCard);\n}\nfunction showEndMessage() {\n  loadMoreBtn.style.display = 'none';\n  endMessage.style.display = 'none';\n}\nasync function handleSearchFormSubmit(event) {\n  event.preventDefault();\n  const search = searchForm.elements.search.value;\n  gallery.innerHTML = '';\n  loader.style.display = 'block';\n  pixabayAPI.resetPage();\n  loadMoreBtn.style.display = 'none';\n  endMessage.style.display = 'none';\n  pixabayAPI.query = searchInput.value.trim();\n  if (search === '') {\n    loader.style.display = 'none';\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query.',\n    });\n    return;\n  }\n  searchAndDisplayResults();\n}\nfunction hideLoadMoreButton() {\n  loadMoreBtn.style.display = 'none';\n}\nasync function searchAndDisplayResults() {\n  try {\n    const result = await pixabayAPI.fetchPhotosByQuery();\n    if (result.hits.length === 0) {\n        iziToast.error({\n            timeout: 1000,\n            position: 'topRight',\n            message: 'Sorry, there are no images matching your search query. Please try again!',\n      });\n    }\n    const lastPage = Math.ceil(result.totalHits / pixabayAPI.perPage);\n    if (result.totalHits > pixabayAPI.perPage) {\n      const firstChild = gallery.firstElementChild;\n      if (firstChild) {\n        card = firstChild.getBoundingClientRect().height;\n      }\n      gallery.innerHTML += createMarkup(result);\n      lightbox.refresh();\n      smoothScrollByCard();\n      loadMoreBtn.style.display = 'block';\n    }\n    if (lastPage === pixabayAPI.page) {\n      hideLoadMoreButton();\n      iziToast.error({\n            timeout: 1000,\n            position: 'topRight',\n            message: \"We're sorry, but you've reached the end of search results.\",\n      });\n\n    }\n  } finally {\n    loader.style.display = 'none';\n  }\n}\nsearchForm.addEventListener('submit', handleSearchFormSubmit);\nloadMoreBtn.addEventListener('click', async () => {\n  loader.style.display = 'block';\n  pixabayAPI.page += 1;\n  searchAndDisplayResults();\n});\n"],"names":["axios","API_KEY","PixabayAPI","perPage","response","createMarkup","data","pixabayAPI","gallery","loadMoreBtn","loader","searchForm","searchInput","endMessage","lightbox","SimpleLightbox","card","smoothScrollByCard","scrollAmount","handleSearchFormSubmit","event","search","iziToast","searchAndDisplayResults","hideLoadMoreButton","result","lastPage","firstChild"],"mappings":"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"}