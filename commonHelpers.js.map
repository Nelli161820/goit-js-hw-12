{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst API_KEY = '42494540-1ca0643de0a334de28e64a581';\n\nexport class PixabayAPI {\n  constructor(perPage) {\n    this.page = 1;\n    this.query = null;\n    this.perPage = perPage || 15;\n    this.lastPage = null;\n  }\n\n  async fetchPhotosByQuery() {\n    const response = await axios.get('', {\n      params: {\n        image_type: 'photo',\n        orientation: 'horizontal',\n        q: this.query,\n        page: this.page,\n        per_page: this.perPage,\n        key: API_KEY,\n        safesearch: true,\n      },\n    });\n\n    if (response.status === 200) {\n      this.page++;\n      console.log('API Response:', response.data);\n      return response.data;\n    } else {\n      console.error('Error fetching photos:', response.statusText);\n      return null;\n    }\n  }\n  \n  resetPage() {\n    this.page = 1;\n  }\n}\n","export function createMarkup(data) {\n  return data.hits\n    .map(\n      data =>\n        `<li class=\"image-search\">\n        <a class=\"gallery-link\" href=\"${data.largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${data.webformatURL}\" alt=\"${data.tags}\"/>\n        </a>\n        <ul class=\"gallery-image-info\">\n          <li class=\"image-items\">\n            <p class=\"image-info\"><span class=\"text\">Likes</span>${data.likes}</p>\n            <p class=\"image-info\"><span class=\"text\">Views</span>${data.views}</p>\n            <p class=\"image-info\"><span class=\"text\">Comments</span>${data.comments}</p>\n            <p class=\"image-info\"><span class=\"text\">Downloads</span>${data.downloads}</p>\n          </li>\n        </ul>\n      </li>`\n    )\n    .join('');\n}\n","// Описаний у документації\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// Описаний у документації\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { PixabayAPI } from './js/pixabay-api.js';\nimport { createMarkup } from './js/render-functions.js';\n\nconst pixabayAPI = new PixabayAPI();\nconst gallery = document.getElementById('gallery-container');\nconst loadMoreBtn = document.getElementById('load-more-btn');\nconst loader = document.getElementById('loading-indicator');\nconst searchForm = document.getElementById('search-form');\nconst searchInput = document.getElementById('search-input');\nconst endMessage = document.getElementById('end-of-results-message');\nconst lightbox = new SimpleLightbox('.gallery a', {\n  nav: true,\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 150,\n});\nendMessage.textContent = \"We're sorry, but you've reached the end of search results.\";\nendMessage.style.display = 'none';\nloadMoreBtn.style.display = 'none';\nlet card = 0;\n\n\n\nfunction smoothScrollByCard() {\n  const scrollAmount = card * 2;\n  window.scrollBy({ top: scrollAmount, behavior: 'smooth' });\n  console.log(smoothScrollByCard);\n}\n\n\nfunction showEndMessage() {\n  loadMoreBtn.style.display = 'none';\n  endMessage.style.display = 'none';\n}\n\nasync function handleSearchFormSubmit(event) {\n  event.preventDefault();\n  const search = searchForm.elements.search.value;\n  gallery.innerHTML = '';\n  loader.style.display = 'block';\n  pixabayAPI.resetPage();\n  loadMoreBtn.style.display = 'none';\n  endMessage.style.display = 'none';\n  pixabayAPI.query = searchInput.value.trim();\n\n     if (search === '') {\n         iziToast.error({\n         title: 'Error',\n         message: 'Please enter a search query.',\n});\n     return;\n}\n  \n  \n  async function initialSearchAndDisplayResults() {\n       try {\n          const data = await searchAndDisplayResults();\n               if (data && data.hits.length === 0) {\n                   iziToast.error({\n                   timeout: 1000,\n                   position: 'topRight',\n                   message:'Sorry, there are no images matching your search query. Please try again!',\n        });\n      }\n    }\n      catch (error) {\n          console.error('Error during initial search:', error);\n    }\n  }\n  initialSearchAndDisplayResults();\n  loadMoreBtn.style.display = 'block';\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreBtn.style.display = 'none';\n}\n  \nasync function searchAndDisplayResults() {\n     try {\n           const result = await pixabayAPI.fetchPhotosByQuery();\n                if (result && result.hits.length > 0) {\n                   const firstChild = gallery.firstElementChild;\n                       if (firstChild) {\n                           card = firstChild.getBoundingClientRect().height;\n}\n                    gallery.innerHTML += createMarkup(result);\n                    lightbox.refresh();\n                    smoothScrollByCard();\n                            if (result.totalHits <= pixabayAPI.page * pixabayAPI.perPage) {\n                                showEndMessage();\n                                hideLoadMoreButton();\n      }\n                }\n                else {\n                      showEndMessage();\n                      hideLoadMoreButton();\n    }\n     }\n     \n     finally {\n    loader.style.display = 'none';\n  }\n}\n\nsearchForm.addEventListener('submit', handleSearchFormSubmit);\nloadMoreBtn.addEventListener('click', async () => {\n  loader.style.display = 'block';\n  await searchAndDisplayResults();\n});"],"names":["axios","API_KEY","PixabayAPI","perPage","response","createMarkup","data","pixabayAPI","gallery","loadMoreBtn","loader","searchForm","searchInput","endMessage","lightbox","SimpleLightbox","card","smoothScrollByCard","scrollAmount","showEndMessage","handleSearchFormSubmit","event","search","iziToast","initialSearchAndDisplayResults","searchAndDisplayResults","error","hideLoadMoreButton","result","firstChild"],"mappings":"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"}